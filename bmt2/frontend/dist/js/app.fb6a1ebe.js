(function(){"use strict";var e={2078:function(e,t,o){var r=o(9242),s=o(3396);const a={id:"app"};function n(e,t,o,r,n,i){const l=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s.Wm)(l)])}var i={name:"App"},l=o(89);const c=(0,l.Z)(i,[["render",n]]);var h=c,d=o(2483);const u={id:"app"},w=(0,s._)("h1",null,"Welcome to the Ticket Booking App",-1),p=(0,s._)("p",null,"This is the homepage of the ticket booking app.",-1),m=(0,s._)("p",null,"You can login or register to start booking tickets.",-1),g=(0,s._)("div",null,null,-1),k=(0,s._)("a",{href:"/register"},"Register",-1);function y(e,t,o,r,a,n){const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",u,[w,p,m,n.isLoggedIn?n.isAdmin?((0,s.wg)(),(0,s.j4)(i,{key:1,to:{path:"/AdminPage"}},{default:(0,s.w5)((()=>[(0,s.Uk)("Admin Dashboard")])),_:1})):((0,s.wg)(),(0,s.j4)(i,{key:2,to:{path:"/UserDashboard"}},{default:(0,s.w5)((()=>[(0,s.Uk)("User Dashboard")])),_:1})):((0,s.wg)(),(0,s.j4)(i,{key:0,to:{path:"/login"}},{default:(0,s.w5)((()=>[(0,s.Uk)("Login")])),_:1})),g,k])}var _={name:"App",computed:{isLoggedIn(){return null!==localStorage.getItem("access_token")},isAdmin(){const e=localStorage.getItem("roles");return e&&e.includes("admin")}}};const v=(0,l.Z)(_,[["render",y]]);var f=v,b=o(7139);const T=(0,s._)("h1",null,"Login",-1),S={key:0,class:"error"},D=(0,s._)("label",{for:"username"},"Username:",-1),C=(0,s._)("label",{for:"password"},"Password:",-1),E=(0,s._)("div",null,[(0,s._)("button",{type:"submit"},"Login")],-1);function U(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[T,n.error?((0,s.wg)(),(0,s.iD)("p",S,(0,b.zw)(n.error),1)):(0,s.kq)("",!0),(0,s._)("form",{onSubmit:t[2]||(t[2]=(0,r.iM)(((...e)=>i.submitForm&&i.submitForm(...e)),["prevent"]))},[(0,s._)("div",null,[D,(0,s.wy)((0,s._)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),required:""},null,512),[[r.nr,n.username]])]),(0,s._)("div",null,[C,(0,s.wy)((0,s._)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),required:""},null,512),[[r.nr,n.password]])]),E],32)])}o(7658);var x=o(6265),z=o.n(x),A={data(){return{username:"",password:"",error:""}},methods:{submitForm(){const e={username:this.username,password:this.password};z().post("http://127.0.0.1:5000/login",e).then((e=>{console.log(e.data);const{username:t,roles:o,access_token:r}=e.data;localStorage.setItem("access_token",r),localStorage.setItem("username",t),localStorage.setItem("roles",JSON.stringify(o)),e.data.roles.includes("admin")?this.$router.push("/AdminPage"):this.$router.push("/UserDashboard")})).catch((e=>{e.response?(console.error("Error status:",e.response.status),console.error("Error message:",e.response.data.error),this.error="Invalid username or password"):e.request?(console.error("No response received..:",e.request),this.error="No response received"):(console.error("Error setting up the request:",e.message),this.error="An error occurred")}))}}};const I=(0,l.Z)(A,[["render",U]]);var V=I;const M=(0,s._)("h1",null,"Sign Up",-1),$=(0,s._)("label",{for:"username"},"Username:",-1),P=(0,s._)("label",{for:"email"},"Email:",-1),q=(0,s._)("label",{for:"password"},"Password:",-1),F=(0,s._)("div",null,[(0,s._)("button",{type:"submit"},"Sign Up")],-1);function L(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[M,(0,s._)("form",{onSubmit:t[3]||(t[3]=(0,r.iM)(((...e)=>i.submitForm&&i.submitForm(...e)),["prevent"]))},[(0,s._)("div",null,[$,(0,s.wy)((0,s._)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),required:""},null,512),[[r.nr,n.username]])]),(0,s._)("div",null,[P,(0,s.wy)((0,s._)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e),required:""},null,512),[[r.nr,n.email]])]),(0,s._)("div",null,[q,(0,s.wy)((0,s._)("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),required:""},null,512),[[r.nr,n.password]])]),F],32)])}var B={data(){return{username:"",email:"",password:""}},methods:{submitForm(){const e={username:this.username,email:this.email,password:this.password};fetch("http://127.0.0.1:5000/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log("Signup success:",e)})).catch((e=>{console.error("Signup error:",e)}))}}};const j=(0,l.Z)(B,[["render",L]]);var O=j;const N=(0,s._)("h1",null,"Promote User to Admin",-1),H=(0,s._)("label",{for:"username"},"Username or User ID:",-1),Z=(0,s._)("div",null,[(0,s._)("button",{type:"submit"},"Promote to Admin")],-1);function Y(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[N,(0,s._)("form",{onSubmit:t[1]||(t[1]=(0,r.iM)(((...e)=>i.promoteUser&&i.promoteUser(...e)),["prevent"]))},[(0,s._)("div",null,[H,(0,s.wy)((0,s._)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>n.usernameOrUserId=e),required:""},null,512),[[r.nr,n.usernameOrUserId]])]),Z],32),n.message?((0,s.wg)(),(0,s.iD)("p",{key:0,class:(0,b.C_)({"success-message":n.success,"error-message":!n.success})},(0,b.zw)(n.message),3)):(0,s.kq)("",!0)])}var G={data(){return{usernameOrUserId:"",message:"",success:null}},methods:{promoteUser(){const e=localStorage.getItem("access_token"),t={Authorization:`Bearer ${e}`};z().post("http://127.0.0.1:5000/promote",{usernameOrUserId:this.usernameOrUserId},{headers:t}).then((e=>{this.message=e.data.message,this.success=!0})).catch((e=>{this.message="Error promoting user to admin.",this.success=!1,console.error(e)}))}}};const K=(0,l.Z)(G,[["render",Y]]);var R=K;const Q=(0,s._)("h1",null,"Admin Page",-1),J=(0,s._)("h2",null,"Create Theatre",-1),W=(0,s._)("label",{for:"name"},"Name:",-1),X=(0,s._)("label",{for:"place"},"Place:",-1),ee=(0,s._)("label",{for:"capacity"},"Capacity:",-1),te=(0,s._)("div",null,[(0,s._)("button",{type:"submit"},"Create Theatre")],-1);function oe(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[Q,(0,s._)("div",null,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>i.showManagement&&i.showManagement(...e))},"showManagement"),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>i.ExportCSV&&i.ExportCSV(...e))},"Export Theatre Data"),(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>i.PromoteToAdmin&&i.PromoteToAdmin(...e))},"Promote To Admin")]),(0,s._)("div",null,[J,(0,s._)("form",{onSubmit:t[7]||(t[7]=(0,r.iM)(((...e)=>i.createTheatre&&i.createTheatre(...e)),["prevent"]))},[(0,s._)("div",null,[W,(0,s.wy)((0,s._)("input",{type:"text",id:"name","onUpdate:modelValue":t[3]||(t[3]=e=>n.theatreName=e),required:""},null,512),[[r.nr,n.theatreName]])]),(0,s._)("div",null,[X,(0,s.wy)((0,s._)("input",{type:"text",id:"place","onUpdate:modelValue":t[4]||(t[4]=e=>n.theatrePlace=e),required:""},null,512),[[r.nr,n.theatrePlace]])]),(0,s._)("div",null,[ee,(0,s.wy)((0,s._)("input",{type:"number",id:"capacity","onUpdate:modelValue":t[5]||(t[5]=e=>n.theatreCapacity=e),required:""},null,512),[[r.nr,n.theatreCapacity]])]),te,(0,s._)("div",null,[(0,s._)("button",{onClick:t[6]||(t[6]=(...e)=>i.viewTheatres&&i.viewTheatres(...e))},"View Available Theatres")])],32)])])}var re={data(){return{theatreName:"",theatrePlace:"",theatreCapacity:""}},methods:{createTheatre(){const e={name:this.theatreName,place:this.theatrePlace,capacity:this.theatreCapacity};z().post("http://127.0.0.1:5000/admin/theatres",e,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then((e=>{console.log("Theatre created successfully!"),console.log("Server response:",e.data)})).catch((e=>{console.error("Error creating theatre:",e.message)}))},viewTheatres(){this.$router.push("/theatres")},ExportCSV(){this.$router.push("/ExportCSV")},showManagement(){this.$router.push("/showManagement")},PromoteToAdmin(){this.$router.push("/PromoteToAdmin")}}};const se=(0,l.Z)(re,[["render",oe]]);var ae=se;const ne=(0,s._)("h2",null,"Available Theatres",-1),ie={key:0,class:"alert alert-success",role:"alert"},le={key:1,class:"alert alert-danger",role:"alert"},ce={key:2},he={key:0},de=["onUpdate:modelValue"],ue=["onClick"],we=["onClick"],pe=["onClick"],me=["onClick"],ge={key:3};function ke(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[ne,n.successMessage?((0,s.wg)(),(0,s.iD)("div",ie,(0,b.zw)(n.successMessage),1)):(0,s.kq)("",!0),n.errorMessage?((0,s.wg)(),(0,s.iD)("div",le,(0,b.zw)(n.errorMessage),1)):(0,s.kq)("",!0),n.theatres.length>0?((0,s.wg)(),(0,s.iD)("ul",ce,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.theatres,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id},[e.editing?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("h3",he,(0,b.zw)(e.name),1)),e.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t=>e.name=t},null,8,de)),[[r.nr,e.name]]):(0,s.kq)("",!0),(0,s._)("p",null,"Location: "+(0,b.zw)(e.place),1),(0,s._)("p",null,"Capacity: "+(0,b.zw)(e.capacity),1),(0,s._)("button",{onClick:t=>i.addShow(e)},"Add Show",8,ue),e.editing?((0,s.wg)(),(0,s.iD)("button",{key:3,onClick:t=>i.saveEdit(e)},"Save",8,pe)):((0,s.wg)(),(0,s.iD)("button",{key:2,onClick:t=>i.toggleEdit(e)},"Edit",8,we)),e.editing?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:4,onClick:t=>i.deleteTheatre(e.id)},"Delete",8,me))])))),128))])):((0,s.wg)(),(0,s.iD)("p",ge,"No theaters found."))])}var ye={data(){return{theatres:[],loading:!0,successMessage:"",errorMessage:""}},mounted(){this.fetchTheatres()},methods:{async fetchTheatres(){try{const e=await fetch("http://127.0.0.1:5000/gettheatres",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(!e.ok)throw new Error("Failed to fetch theatres");const t=await e.json();this.theatres=t.reverse(),this.loading=!1}catch(e){this.error="Error fetching theaters. Please try again later.",console.error(e),this.loading=!1}},addShow(e){this.$router.push({name:"showpage",params:{theatreid:e.id}})},toggleEdit(e){e.editing=!e.editing},async saveEdit(e){try{const t=await fetch(`http://127.0.0.1:5000/edittheatre/${e.id}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({name:e.name})});t.ok?(e.editing=!1,this.successMessage="Theatre name updated successfully!",this.errorMessage=""):(this.successMessage="",this.errorMessage="Failed to save theatre edit")}catch(t){this.successMessage="",this.errorMessage="Error saving theatre edit",console.error("Error saving theatre edit:",t)}},async deleteTheatre(e){const t=window.confirm("Are you sure you want to delete this theatre?");if(t)try{const t=await fetch(`http://127.0.0.1:5000/deletetheatre/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});t.ok?this.theatres=this.theatres.filter((t=>t.id!==e)):console.error("Failed to delete theatre")}catch(o){console.error("Error deleting theatre:",o)}}}};const _e=(0,l.Z)(ye,[["render",ke]]);var ve=_e;const fe={key:0},be=(0,s._)("h2",null,"Add Show",-1),Te=(0,s._)("label",{for:"name"},"Name:",-1),Se=(0,s._)("label",{for:"rating"},"Rating:",-1),De=["id","value"],Ce=["for"],Ee=(0,s._)("label",{for:"ticketPrice"},"Ticket Price:",-1),Ue=(0,s._)("div",null,[(0,s._)("button",{type:"submit"},"Add Show")],-1);function xe(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[n.showFormVisible?((0,s.wg)(),(0,s.iD)("div",fe,[be,(0,s._)("form",{onSubmit:t[4]||(t[4]=(0,r.iM)(((...e)=>i.createShow&&i.createShow(...e)),["prevent"]))},[(0,s._)("div",null,[Te,(0,s.wy)((0,s._)("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>n.show.name=e),required:""},null,512),[[r.nr,n.show.name]])]),(0,s._)("div",null,[Se,(0,s.wy)((0,s._)("input",{type:"number",id:"rating","onUpdate:modelValue":t[1]||(t[1]=e=>n.show.rating=e),min:"1",max:"5",required:""},null,512),[[r.nr,n.show.rating]])]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.genres,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.value},[(0,s.wy)((0,s._)("input",{type:"checkbox",id:e.value,value:e.value,"onUpdate:modelValue":t[2]||(t[2]=e=>n.show.genres=e)},null,8,De),[[r.e8,n.show.genres]]),(0,s._)("label",{for:e.value},(0,b.zw)(e.label),9,Ce)])))),128)),(0,s._)("div",null,[Ee,(0,s.wy)((0,s._)("input",{type:"number",id:"ticket_price","onUpdate:modelValue":t[3]||(t[3]=e=>n.show.ticket_price=e),required:""},null,512),[[r.nr,n.show.ticket_price]])]),Ue],32)])):(0,s.kq)("",!0)])}var ze={data(){return{showFormVisible:!0,show:{name:"",rating:0,genres:[],ticket_price:0},genres:[{label:"Comedy",value:"comedy"},{label:"Action",value:"action"},{label:"Sci-Fi",value:"scifi"},{label:"Romance",value:"romance"},{label:"Horror",value:"horror"},{label:"Drama",value:"drama"},{label:"Fantasy",value:"fantasy"}]}},mounted(){console.log("showpage component mounted")},methods:{async createShow(){console.log("createShow method called");const e=this.$route.params.theatreid;try{const t=await fetch(`http://127.0.0.1:5000/admin/theatres/${e}/add_show`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify(this.show)});if(!t.ok)throw new Error("Failed to add show");console.log("successful")}catch(t){console.error(t)}}}};const Ae=(0,l.Z)(ze,[["render",xe]]);var Ie=Ae;const Ve=(0,s._)("h2",null,"User Dashboard",-1),Me={key:0},$e=(0,s._)("p",null,"No results found.",-1),Pe=[$e],qe={class:"card-header"},Fe={class:"card-body"},Le={class:"card-text"},Be={class:"card-text"},je={key:0,class:"card-text"},Oe=["onClick"],Ne={key:1},He={class:"card-body"},Ze={class:"card-title"},Ye={class:"card-text"},Ge={class:"card-text"},Ke={class:"card-text"},Re={class:"card-text"},Qe={key:0},Je=["onClick","disabled"];function We(e,t,o,a,n,i){const l=(0,s.up)("Header");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(l),Ve,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.searchQuery=e),type:"text",placeholder:"Search by name or place"},null,512),[[r.nr,n.searchQuery]]),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>i.searchTheatres&&i.searchTheatres(...e))},(0,b.zw)(n.isSearching?"Clear":"Search"),1),(0,s._)("label",null,[(0,s.wy)((0,s._)("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=e=>n.searchIn=e),value:"theatres"},null,512),[[r.G2,n.searchIn]]),(0,s.Uk)(" Search in Theatres ")]),(0,s._)("label",null,[(0,s.wy)((0,s._)("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=e=>n.searchIn=e),value:"shows"},null,512),[[r.G2,n.searchIn]]),(0,s.Uk)(" Search in Shows ")]),0===i.filteredTheatres.length&&"theatres"===n.searchIn?((0,s.wg)(),(0,s.iD)("div",Me,Pe)):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.theatres,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id,class:"card mb-3"},[(0,s._)("div",qe,(0,b.zw)(e.name),1),(0,s._)("div",Fe,[(0,s._)("p",Le,"Location: "+(0,b.zw)(e.place),1),(0,s._)("p",Be,"Capacity: "+(0,b.zw)(e.capacity),1),n.isSearching&&"shows"===n.searchIn?((0,s.wg)(),(0,s.iD)("p",je,"Number of matching shows: "+(0,b.zw)(e.shows.length),1)):(0,s.kq)("",!0),(0,s._)("button",{onClick:t=>i.toggleMovies(e.id),class:"btn btn-primary"},(0,b.zw)(e.showMovies?"Hide Movies":"Show Movies"),9,Oe),e.showMovies?((0,s.wg)(),(0,s.iD)("div",Ne,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.shows,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id,class:"card mb-2"},[(0,s._)("div",He,[(0,s._)("h5",Ze,(0,b.zw)(t.name),1),(0,s._)("p",Ye,"Rating: "+(0,b.zw)(t.rating),1),(0,s._)("p",Ge,"Genres: "+(0,b.zw)(t.genres.join(", ")),1),(0,s._)("p",Ke,"Ticket Price: $"+(0,b.zw)(t.ticket_price),1),(0,s._)("p",Re,"Available Seats: "+(0,b.zw)(t.available_seats),1),t.is_house_full?((0,s.wg)(),(0,s.iD)("p",Qe,"House Full!")):((0,s.wg)(),(0,s.iD)("button",{key:1,onClick:o=>i.bookShow(e.id,t.id),disabled:0===t.available_seats,class:"btn btn-success"}," Book Now ",8,Je))])])))),128))])):(0,s.kq)("",!0)])])))),128))])}const Xe={class:"header"};function et(e,t,o,r,a,n){return(0,s.wg)(),(0,s.iD)("div",Xe,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e))},"Logout"),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>n.viewBookedTickets&&n.viewBookedTickets(...e))},"Booked Tickets")])}var tt={methods:{logout(){localStorage.removeItem("access_token"),this.$router.push("/")},viewBookedTickets(){try{this.$router.push("/booked")}catch(e){console.error(e)}}}};const ot=(0,l.Z)(tt,[["render",et]]);var rt=ot,st={components:{Header:rt},data(){return{theatres:[],originalTheatres:[],searchQuery:"",isSearching:!1,searchIn:"theatres"}},computed:{filteredTheatres(){const e=this.searchQuery.toLowerCase().trim();return e?this.theatres.filter((t=>t.name.toLowerCase().includes(e)||t.place.toLowerCase().includes(e))):this.theatres}},mounted(){this.fetchTheatresData()},methods:{async fetchTheatresData(){try{const e=await fetch("http://127.0.0.1:5000/user/dashboard",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(!e.ok)throw new Error("Failed to fetch theatre data");const t=await e.json();this.originalTheatres=t.reverse(),this.theatres=t.map((e=>({...e,showMovies:!1})))}catch(e){console.error(e)}},async bookShow(e,t){this.$router.push({name:"booking",params:{theatreId:e,showId:t}})},toggleMovies(e){this.theatres=this.theatres.map((t=>t.id===e?{...t,showMovies:!t.showMovies}:t))},searchTheatres(){if(this.isSearching)this.isSearching=!1,this.searchQuery="",this.theatres="theatres"===this.searchIn?this.originalTheatres:this.filterTheatres("");else{this.isSearching=!0;const e=this.searchQuery.trim().toLowerCase();this.theatres=this.filterTheatres(e)}},filterTheatres(e){const t=e.toLowerCase().trim();return"theatres"===this.searchIn?this.originalTheatres.filter((e=>e.name.toLowerCase().includes(t)||e.place.toLowerCase().includes(t))):"shows"===this.searchIn?this.originalTheatres.map((e=>{const o=e.shows.filter((e=>e.name.toLowerCase().includes(t)||e.genres.some((e=>e.toLowerCase().includes(t)))||e.rating.toString().includes(t)));return{...e,shows:o}})):void 0}}};const at=(0,l.Z)(st,[["render",We]]);var nt=at;const it=(0,s._)("h2",null,"Booking Page",-1),lt={key:0},ct={key:0},ht=(0,s._)("label",{for:"numTickets"},"Number of Tickets:",-1),dt=["max","disabled"],ut={key:1},wt={key:2},pt=["disabled"],mt={key:1},gt=(0,s._)("p",null,"Loading show details...",-1),kt=[gt],yt=(0,s._)("span",null,"×",-1),_t=[yt];function vt(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[it,n.show?((0,s.wg)(),(0,s.iD)("div",lt,[(0,s._)("h3",null,(0,b.zw)(n.show.name),1),(0,s._)("p",null,"Rating: "+(0,b.zw)(n.show.rating),1),(0,s._)("p",null,"Genres: "+(0,b.zw)(n.show.genres.join(", ")),1),(0,s._)("p",null,"Ticket Price: $"+(0,b.zw)(n.show.ticket_price),1),(0,s._)("p",null,"Available Seats: "+(0,b.zw)(n.show.available_seats),1),n.show.is_house_full?((0,s.wg)(),(0,s.iD)("p",ct,"House Full!")):(0,s.kq)("",!0),ht,(0,s.wy)((0,s._)("input",{type:"number",id:"numTickets","onUpdate:modelValue":t[0]||(t[0]=e=>n.numTickets=e),max:n.show.available_seats,disabled:n.show.is_house_full},null,8,dt),[[r.nr,n.numTickets,void 0,{number:!0}]]),n.numTickets>0?((0,s.wg)(),(0,s.iD)("p",ut,"Price per Ticket: $"+(0,b.zw)(n.show.ticket_price),1)):(0,s.kq)("",!0),n.numTickets>0?((0,s.wg)(),(0,s.iD)("p",wt,"Total Price: $"+(0,b.zw)(n.numTickets*n.show.ticket_price),1)):(0,s.kq)("",!0),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>i.bookTickets&&i.bookTickets(...e)),disabled:n.numTickets<=0||n.show.is_house_full},"Book Tickets",8,pt)])):((0,s.wg)(),(0,s.iD)("div",mt,kt)),n.alertMessage?((0,s.wg)(),(0,s.iD)("div",{key:2,class:(0,b.C_)(["alert alert-dismissible fade show",n.alertType])},[(0,s.Uk)((0,b.zw)(n.alertMessage)+" ",1),(0,s._)("button",{type:"button",class:"close",onClick:t[2]||(t[2]=(...e)=>i.closeAlert&&i.closeAlert(...e))},_t)],2)):(0,s.kq)("",!0)])}var ft={data(){return{show:null,numTickets:0,alertMessage:"",alertType:""}},async created(){const e=this.$route.params.showId;this.fetchShowData(e)},methods:{async fetchShowData(e){try{const t=await fetch(`http://127.0.0.1:5000/bookings/${e}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(!t.ok)throw new Error("Failed to fetch show data");const o=await t.json();this.show=o}catch(t){console.error(t)}},async bookTickets(){try{const e=await fetch(`http://127.0.0.1:5000/bookings/${this.show.id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({numTickets:this.numTickets})});if(!e.ok)throw new Error("Failed to book tickets");this.showAlert("Tickets booked successfully!","alert-success"),this.fetchShowData(this.show.id)}catch(e){console.error(e),this.showAlert("Failed to book tickets","alert-danger")}},showAlert(e,t){this.alertMessage=e,this.alertType=t,setTimeout(this.closeAlert,3e3)},closeAlert(){this.alertMessage="",this.alertType=""}}};const bt=(0,l.Z)(ft,[["render",vt]]);var Tt=bt;const St=(0,s._)("h2",null,"My Booked Tickets",-1),Dt={key:0},Ct=(0,s._)("strong",null,"Show Name:",-1),Et=(0,s._)("strong",null,"Number of Tickets:",-1),Ut=(0,s._)("strong",null,"Total Price:",-1),xt=(0,s._)("hr",null,null,-1),zt={key:1},At=(0,s._)("p",null,"No booked tickets found.",-1),It=[At];function Vt(e,t,o,r,a,n){return(0,s.wg)(),(0,s.iD)("div",null,[St,a.bookedTickets.length>0?((0,s.wg)(),(0,s.iD)("div",Dt,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.bookedTickets,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t},[(0,s._)("p",null,[Ct,(0,s.Uk)(" "+(0,b.zw)(e.show_name),1)]),(0,s._)("p",null,[Et,(0,s.Uk)(" "+(0,b.zw)(e.num_tickets),1)]),(0,s._)("p",null,[Ut,(0,s.Uk)(" $"+(0,b.zw)(e.total_price),1)]),xt])))),128))])])):((0,s.wg)(),(0,s.iD)("div",zt,It))])}var Mt={data(){return{bookedTickets:[]}},created(){this.fetchBookedTickets()},methods:{async fetchBookedTickets(){try{const e=await fetch("http://127.0.0.1:5000/user/booked-tickets",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(!e.ok)throw new Error("Failed to fetch booked tickets");const t=await e.json();this.bookedTickets=t.reverse()}catch(e){console.error(e)}}}};const $t=(0,l.Z)(Mt,[["render",Vt]]);var Pt=$t;const qt=(0,s._)("h1",null,"Theatre CSV Export",-1),Ft=(0,s._)("label",{for:"theatreId"},"Select Theatre:",-1),Lt=["value"],Bt=(0,s._)("button",{type:"submit"},"Export CSV",-1),jt={key:0},Ot={key:1},Nt={key:2},Ht=["href"];function Zt(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",null,[qt,(0,s._)("form",{onSubmit:t[1]||(t[1]=(0,r.iM)(((...e)=>i.exportCSV&&i.exportCSV(...e)),["prevent"]))},[Ft,(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedTheatre=e),required:""},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.theatres,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id},(0,b.zw)(e.name)+" ID:"+(0,b.zw)(e.id),9,Lt)))),128))],512),[[r.bM,n.selectedTheatre]]),Bt],32),n.exporting?((0,s.wg)(),(0,s.iD)("p",jt,"Export in progress...")):(0,s.kq)("",!0),n.exportedFile?((0,s.wg)(),(0,s.iD)("p",Ot,(0,b.zw)(n.exportedFile),1)):(0,s.kq)("",!0),n.downloadLink?((0,s.wg)(),(0,s.iD)("p",Nt,[(0,s._)("a",{href:n.downloadLink,download:""},"Download CSV",8,Ht)])):(0,s.kq)("",!0)])}o(6229),o(7330),o(2062);var Yt={data(){return{selectedTheatre:null,exporting:!1,exportedFile:null,downloadLink:null,theatres:[]}},methods:{async fetchTheatres(){try{const e=await fetch("http://127.0.0.1:5000/exportTheatres",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();this.theatres=t}else console.error("Failed to fetch theatre data")}catch(e){console.error("Error fetching theatre data:",e)}},async exportCSV(){if(!this.selectedTheatre)return;this.exporting=!0;const e=await fetch(`http://127.0.0.1:5000/export-csv/${this.selectedTheatre}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();console.log(t),this.exportedFile=t.message,this.downloadLink=t.download_link,alert("CSV export completed!")}else console.error("Failed to export CSV");this.exporting=!1},async fetchDownloadLink(){if(this.exportedFile){this.fetchingDownloadLink=!0;try{const t=await fetch(`http://127.0.0.1:5000/download-csv/${this.selectedTheatre}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(t.ok)try{const e=await t.blob(),o=URL.createObjectURL(e),r=this.exportedFile;this.downloadLink=o,this.downloadFilename=r,alert("CSV export completed!")}catch(e){console.error("Error creating Blob:",e)}else console.error("Failed to export CSV")}catch(e){console.error("Error fetching download link:",e)}this.fetchingDownloadLink=!1}}},watch:{exportedFile:"fetchDownloadLink"},mounted(){this.fetchTheatres()}};const Gt=(0,l.Z)(Yt,[["render",Zt]]);var Kt=Gt;const Rt={class:"container mt-4"},Qt=(0,s._)("h2",null,"Theatre Management",-1),Jt={key:0,class:"alert alert-success",role:"alert"},Wt={key:1,class:"alert alert-danger",role:"alert"},Xt={key:2,class:"alert alert-success",role:"alert"},eo={key:3,class:"alert alert-danger",role:"alert"},to=(0,s._)("strong",null,"Show Name:",-1),oo=["onUpdate:modelValue"],ro=(0,s._)("strong",null,"Rating:",-1),so=["onUpdate:modelValue"],ao=(0,s._)("strong",null,"Genres:",-1),no=["onUpdate:modelValue"],io=(0,s._)("strong",null,"Ticket Price:",-1),lo=["onUpdate:modelValue"],co=["onClick"],ho=["onClick"],uo=["onClick"];function wo(e,t,o,a,n,i){return(0,s.wg)(),(0,s.iD)("div",Rt,[Qt,n.showEditedSuccess?((0,s.wg)(),(0,s.iD)("div",Jt," Show edited successfully! ")):(0,s.kq)("",!0),n.showEditedError?((0,s.wg)(),(0,s.iD)("div",Wt," Error editing show. Please try again. ")):(0,s.kq)("",!0),n.showDeletedSuccess?((0,s.wg)(),(0,s.iD)("div",Xt," Show deleted successfully! ")):(0,s.kq)("",!0),n.showDeletedError?((0,s.wg)(),(0,s.iD)("div",eo," Error deleting show. Please try again. ")):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.theatres,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"mb-4"},[(0,s._)("h3",null,(0,b.zw)(e.name),1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.shows,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id},[(0,s._)("div",null,[to,e.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:0,"onUpdate:modelValue":t=>e.name=t},null,8,oo)),[[r.nr,e.name]]):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)((0,b.zw)(e.name),1)],64))]),(0,s._)("div",null,[ro,e.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:0,"onUpdate:modelValue":t=>e.rating=t},null,8,so)),[[r.nr,e.rating]]):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)((0,b.zw)(e.rating),1)],64))]),(0,s._)("div",null,[ao,e.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:0,"onUpdate:modelValue":t=>e.genres=t},null,8,no)),[[r.nr,e.genres]]):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)((0,b.zw)(e.genres),1)],64))]),(0,s._)("div",null,[io,e.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:0,"onUpdate:modelValue":t=>e.ticket_price=t},null,8,lo)),[[r.nr,e.ticket_price]]):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)((0,b.zw)(e.ticket_price),1)],64))]),(0,s._)("button",{onClick:t=>i.toggleEdit(e)},"Toggle Edit",8,co),e.editing?((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:t=>i.saveEdit(e)},"Save",8,ho)):(0,s.kq)("",!0),(0,s._)("button",{onClick:t=>i.deleteShow(e)},"Delete",8,uo)])))),128))])))),128))])}var po={data(){return{theatres:{},showEditedSuccess:!1,showEditedError:!1,showDeletedSuccess:!1,showDeletedError:!1}},methods:{async fetchShows(){try{const e=await z().get("http://127.0.0.1:5000/getshows",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});200===e.status?this.theatres=e.data.reverse():console.error("Failed to fetch shows")}catch(e){console.error("Error fetching shows:",e)}},async toggleEdit(e){e.editing=!e.editing},async saveEdit(e){try{const t=await z().put(`http://127.0.0.1:5000/editshow/${e.id}`,{name:e.name,rating:e.rating,genres:e.genres,ticket_price:e.ticket_price},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});200===t.status?(this.showEditedSuccess=!0,await this.fetchShows(),setTimeout((()=>{this.showEditedSuccess=!1}),3e3)):(this.showEditedError=!0,setTimeout((()=>{this.showEditedError=!1}),3e3))}catch(t){console.error("Error editing show:",t),this.showEditedSuccess=!1,this.showEditedError=!0,setTimeout((()=>{this.showEditedError=!1}),3e3)}},async deleteShow(e){const t=window.confirm("Are you sure you want to delete this show?");if(t)try{const t=await z()["delete"](`http://127.0.0.1:5000/deleteshow/${e.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});200===t.status?(this.showDeletedSuccess=!0,await this.fetchShows(),setTimeout((()=>{this.showDeletedSuccess=!1}),3e3)):(this.showDeletedError=!0,setTimeout((()=>{this.showDeletedError=!1}),3e3))}catch(o){console.error("Error deleting show:",o),this.showDeletedSuccess=!1,this.showDeletedError=!0,setTimeout((()=>{this.showDeletedError=!1}),3e3)}}},mounted(){this.fetchShows()}};const mo=(0,l.Z)(po,[["render",wo]]);var go=mo;const ko=[{path:"/",name:"index",component:f},{path:"/login",name:"login",component:V},{path:"/register",name:"register",component:O},{path:"/PromoteToAdmin",name:"PromoteToAdmin",component:R},{path:"/AdminPage",name:"AdminPage",component:ae},{path:"/theatres",name:"TheatreList",component:ve},{path:"/showpage/:theatreid",name:"showpage",component:Ie,props:!0},{path:"/UserDashboard",name:"UserDashboard",component:nt},{path:"/booking/:showId",name:"booking",component:Tt,props:!0},{path:"/booked",name:"booked",component:Pt},{path:"/ExportCSV",name:"ExportCSV",component:Kt},{path:"/showManagement",name:"showManagement",component:go}],yo=(0,d.p7)({history:(0,d.PO)(),routes:ko});var _o=yo;const vo=(0,r.ri)(h);vo.use(_o),vo.mount("#app")}},t={};function o(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,r,s,a){if(!r){var n=1/0;for(h=0;h<e.length;h++){r=e[h][0],s=e[h][1],a=e[h][2];for(var i=!0,l=0;l<r.length;l++)(!1&a||n>=a)&&Object.keys(o.O).every((function(e){return o.O[e](r[l])}))?r.splice(l--,1):(i=!1,a<n&&(n=a));if(i){e.splice(h--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[r,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,a,n=r[0],i=r[1],l=r[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(s in i)o.o(i,s)&&(o.m[s]=i[s]);if(l)var h=l(o)}for(t&&t(r);c<n.length;c++)a=n[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(h)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(2078)}));r=o.O(r)})();
//# sourceMappingURL=app.fb6a1ebe.js.map